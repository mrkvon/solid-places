import"../chunks/DsnmJJEf.js";import{p as te,ab as he,a4 as ie,z as Oe,a as E,b as ae,f as G,a6 as h,a8 as P,a7 as v,a5 as Ie,a3 as Fe,R as rt,B as Pe,d as we,h as c,ac as Z,n as nt,t as st}from"../chunks/B8Aoszw1.js";import{I as xe,X as Ve,s as ft,e as Ue,r as Me,a as N,B as pt,b as Be}from"../chunks/ClX5RZE4.js";import{a as o,s as ke,b as Ee}from"../chunks/DoVozA40.js";import{w as bt,d as ht,c as Ce,f as it,b as Ae,i as gt}from"../chunks/v_5uegaS.js";import{s as Re,r as qe,i as se,p as mt}from"../chunks/BBaN-TA8.js";import{t as Je,o as yt,w as _t,p as $t,q as wt,m as pe,e as Ge,b as Ne,k as je,c as kt,r as Ke,v as De,x as Pt,y as Et,z as It,n as me,A as Ot,B as xt,u as Ct,C as Qe,D as Rt,a as Xe,f as j,j as qt,E as St,L as Tt}from"../chunks/C1_8t2Gq.js";import{h as Ye,F as ye,a as _e,T as $e}from"../chunks/DLesLHD-.js";import{h as He,i as ot,j as Nt,k as Ze,b as Le,l as jt,u as lt,m as Dt,a as Mt}from"../chunks/CyzmgiJC.js";import{s as Lt}from"../chunks/yBE5bFW0.js";import{c as Wt,P as Bt}from"../chunks/Bt4gQG3w.js";import{f as Ft,a as Ut,q as At,r as Vt,s as Ht}from"../chunks/Bws1Dooa.js";import{P as zt}from"../chunks/BP_ug7av.js";import{P as Jt}from"../chunks/BzEzGBMK.js";const{name:be}=kt("dialog"),Gt={preventScroll:!0,escapeBehavior:"close",closeOnOutsideClick:!0,role:"dialog",defaultOpen:!1,portal:"body",forceVisible:!1,openFocus:void 0,closeFocus:void 0,onOutsideClick:void 0},Kt=["content","title","description"];function ct(y){const e={...Gt,...y},t=Je(yt(e,"ids")),{preventScroll:g,escapeBehavior:n,closeOnOutsideClick:I,role:i,portal:s,forceVisible:L,openFocus:V,closeFocus:T,onOutsideClick:_}=t,O=_t.writable(null),x=Je({...$t(Kt),...e.ids}),H=e.open??bt(e.defaultOpen),q=wt(H,e?.onOpenChange),D=ht([q,L],([a,p])=>a||p);let z=me;function C(a){const p=a.currentTarget,u=a.currentTarget;!Xe(p)||!Xe(u)||(q.set(!0),O.set(u))}function M(){q.set(!1)}const Y=pe(be("trigger"),{stores:[q],returned:([a])=>({"aria-haspopup":"dialog","aria-expanded":a,type:"button"}),action:a=>({destroy:Ge(Ne(a,"click",u=>{C(u)}),Ne(a,"keydown",u=>{u.key!==je.ENTER&&u.key!==je.SPACE||(u.preventDefault(),C(u))}))})}),$=pe(be("overlay"),{stores:[D,q],returned:([a,p])=>({hidden:a?void 0:!0,tabindex:-1,style:a?void 0:Ke({display:"none"}),"aria-hidden":!0,"data-state":p?"open":"closed"})}),K=pe(be("content"),{stores:[D,x.content,x.description,x.title,q],returned:([a,p,u,R,le])=>({id:p,role:i.get(),"aria-describedby":u,"aria-labelledby":R,"aria-modal":a?"true":void 0,"data-state":le?"open":"closed",tabindex:-1,hidden:a?void 0:!0,style:a?void 0:Ke({display:"none"})}),action:a=>{let p=me,u=me,R=me;const le=De([D,I],([b,l])=>{u(),p(),R(),b&&(u=Pt(a,{closeOnInteractOutside:l,onClose:M,shouldCloseOnInteractOutside(f){return _.get()?.(f),!f.defaultPrevented}}).destroy,p=Et(a,{handler:M,behaviorType:n}).destroy,R=It(a,{fallbackFocus:a}).destroy)});return{destroy:()=>{z(),le(),u(),p(),R()}}}}),w=pe(be("portalled"),{stores:s,returned:a=>({"data-portal":Ot(a)}),action:a=>{const p=De([s],([u])=>{if(u===null)return me;const R=xt(a,u);return R===null?me:Ct(a,R).destroy});return{destroy(){p()}}}}),re=pe(be("title"),{stores:[x.title],returned:([a])=>({id:a})}),ve=pe(be("description"),{stores:[x.description],returned:([a])=>({id:a})}),oe=pe(be("close"),{returned:()=>({type:"button"}),action:a=>({destroy:Ge(Ne(a,"click",()=>{M()}),Ne(a,"keydown",u=>{u.key!==je.SPACE&&u.key!==je.ENTER||(u.preventDefault(),M())}))})});return De([q,g],([a,p])=>{if(Qe){if(p&&a&&(z=Rt()),a){const u=document.getElementById(x.content.get());Ye({prop:V.get(),defaultEl:u})}return()=>{L.get()||z()}}}),De(q,a=>{!Qe||a||Ye({prop:T.get(),defaultEl:O.get()})},{skipFirstRun:!0}),{ids:x,elements:{content:K,trigger:Y,title:re,description:ve,overlay:$,close:oe,portalled:w},states:{open:q},options:t}}function et(y,e){te(e,!0);/**
 * @license @lucide/svelte v0.535.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */let t=qe(e,["$$slots","$$events","$$legacy"]);const g=[["path",{d:"M21.54 15H17a2 2 0 0 0-2 2v4.54"}],["path",{d:"M7 3.34V5a3 3 0 0 0 3 3a2 2 0 0 1 2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2c0-1.1.9-2 2-2h3.17"}],["path",{d:"M11 21.95V18a2 2 0 0 0-2-2a2 2 0 0 1-2-2v-1a2 2 0 0 0-2-2H2.05"}],["circle",{cx:"12",cy:"12",r:"10"}]];xe(y,Re({name:"earth"},()=>t,{get iconNode(){return g},children:(n,I)=>{var i=he(),s=ie(i);Ce(s,()=>e.children??Oe),E(n,i)},$$slots:{default:!0}})),ae()}function tt(y,e){te(e,!0);/**
 * @license @lucide/svelte v0.535.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */let t=qe(e,["$$slots","$$events","$$legacy"]);const g=[["circle",{cx:"12",cy:"16",r:"1"}],["rect",{x:"3",y:"10",width:"18",height:"12",rx:"2"}],["path",{d:"M7 10V7a5 5 0 0 1 10 0v3"}]];xe(y,Re({name:"lock-keyhole"},()=>t,{get iconNode(){return g},children:(n,I)=>{var i=he(),s=ie(i);Ce(s,()=>e.children??Oe),E(n,i)},$$slots:{default:!0}})),ae()}function Qt(y,e){te(e,!0);/**
 * @license @lucide/svelte v0.535.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */let t=qe(e,["$$slots","$$events","$$legacy"]);const g=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"}],["path",{d:"m15 5 4 4"}]];xe(y,Re({name:"pencil"},()=>t,{get iconNode(){return g},children:(n,I)=>{var i=he(),s=ie(i);Ce(s,()=>e.children??Oe),E(n,i)},$$slots:{default:!0}})),ae()}function Xt(y,e){te(e,!0);/**
 * @license @lucide/svelte v0.535.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */let t=qe(e,["$$slots","$$events","$$legacy"]);const g=[["path",{d:"M10 11v6"}],["path",{d:"M14 11v6"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}],["path",{d:"M3 6h18"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}]];xe(y,Re({name:"trash-2"},()=>t,{get iconNode(){return g},children:(n,I)=>{var i=he(),s=ie(i);Ce(s,()=>e.children??Oe),E(n,i)},$$slots:{default:!0}})),ae()}function at(y,e){te(e,!0);/**
 * @license @lucide/svelte v0.535.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */let t=qe(e,["$$slots","$$events","$$legacy"]);const g=[["path",{d:"M18 21a8 8 0 0 0-16 0"}],["circle",{cx:"10",cy:"8",r:"5"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3"}]];xe(y,Re({name:"users-round"},()=>t,{get iconNode(){return g},children:(n,I)=>{var i=he(),s=ie(i);Ce(s,()=>e.children??Oe),E(n,i)},$$slots:{default:!0}})),ae()}var Yt=(y,e,t,g)=>e.onClickRemove(t()),Zt=G('<button type="button"><!></button>'),ea=G('<div class="tag svelte-nisp7u"> <!></div>');function ta(y,e){te(e,!0);const[t,g]=ke(),n=()=>o(I,"$person",t);He(e.webId);let I=ot(ye,e.webId);var i=ea(),s=h(i),L=P(s);{var V=T=>{var _=Zt();_.__click=[Yt,e,n,I];var O=h(_);Ve(O,{"aria-hidden":"true",size:"1.25rem"}),v(_),Ie(()=>ft(_,"aria-label",`Remove ${n().name}`)),E(T,_)};se(L,T=>{e.onClickRemove&&T(V)})}v(i),Ie(()=>Ae(s,`${n().name??""} `)),E(y,i),ae(),g()}it(["click"]);var aa=G("<li> </li>"),ra=G('<li><div><span class="font-medium"> </span></div></li>'),na=G(`<li class="relative cursor-pointer rounded-md py-1 pl-8 pr-4
        data-[highlighted]:bg-magnum-100 data-[highlighted]:text-magnum-700">No results found</li>`),sa=G("<ul><!>  <!></ul>"),ia=G('<div><div><div class="selected-people svelte-8dggyk"></div> <input/></div></div> <!>',1);function oa(y,e){te(e,!0);const[t,g]=ke(),n=()=>o(K,"$inputValue",t),I=()=>o($,"$open",t),i=()=>o(re,"$selected",t),s=()=>o(Le,"$session",t),L=()=>o(w,"$touchedInput",t),V=()=>o(u,"$friends",t),T=()=>o(M,"$input",t),_=()=>o(C,"$menu",t),O=()=>o(c(l),"$personByWebId",t),x=()=>o(c(b),"$personResourceResult",t),H=()=>o(Y,"$option",t),q=()=>o(c(f),"$matched",t);let D=mt(e,"value",15),z=Fe(rt([]));const{elements:{menu:C,input:M,option:Y},states:{open:$,inputValue:K,touchedInput:w,selected:re},helpers:{isSelected:ve,isHighlighted:oe}}=Wt({multiple:!0,onSelectedChange:r=>{const d=r.next?.map(F=>F.value)??[];return Pe(z,d,!0),D(d),Ee(K,""),Ee($,!1),r.next}});we(()=>{D().length!==i()?.length&&Ee(re,D().map(r=>({value:r,label:""})))});let a;const p=r=>{clearTimeout(a),a=setTimeout(r,450)};Nt(ye,s().info.webId,s().info.webId,{name:!0,knows:{name:!0}});let u=Ze(ye,s().info.webId,Ft.knows),R=Fe("");we(()=>{const r=n();L()?p(()=>{Pe(R,r,!0)}):Pe(R,r,!0)});let le=Z(()=>V().filter(r=>r.name?.toLowerCase().includes(n().toLowerCase())||r["@id"]?.toLowerCase().includes(n().toLowerCase()))),b=Z(()=>He(c(R))),l=Z(()=>ot(ye,c(R))),f=Z(()=>Ze(ye,c(R),Ut.oidcIssuer));const W=r=>{D(D().filter(d=>d!==r["@id"]))};var B=ia(),m=ie(B),S=h(m),U=h(S);Ue(U,20,()=>c(z),r=>r,(r,d)=>{ta(r,{get webId(){return d},onClickRemove:W})}),v(U);var J=P(U,2);Me(J),N(J,()=>({...T(),disabled:e.disabled||T().disabled,placeholder:"Name or webId"}),void 0,void 0,"svelte-8dggyk"),j(J,r=>M?.(r)),v(S),v(m);var ee=P(m,2);{var Q=r=>{var d=sa();N(d,()=>({class:"menu",..._()}),void 0,void 0,"svelte-8dggyk");var F=h(d);{var de=X=>{var A=aa();N(A,ne=>({...ne}),[()=>H()({value:O()["@id"],label:O().name??O()["@id"],disabled:x().isPresent()!==!0||q().size===0})],void 0,"svelte-8dggyk");var ce=h(A,!0);v(A),j(A,ne=>Y?.(ne)),Ie(()=>Ae(ce,O().name??O()["@id"])),E(X,A)};se(F,X=>{O()?.["@id"]&&!x()?.isError&&X(de)})}var fe=P(F,2);Ue(fe,17,()=>c(le),X=>X["@id"],(X,A)=>{var ce=ra();N(ce,ge=>({...ge}),[()=>H()({value:c(A)["@id"],label:c(A).name??c(A)["@id"]})],void 0,"svelte-8dggyk");var ne=h(ce),ue=h(ne),Se=h(ue,!0);v(ue),v(ne),v(ce),j(ce,ge=>Y?.(ge)),Ie(()=>Ae(Se,c(A).name??c(A)["@id"])),E(X,ce)},X=>{var A=na();E(X,A)}),v(d),j(d,X=>C?.(X)),qt(3,d,()=>St,()=>({duration:150,y:-5})),E(r,d)};se(ee,r=>{I()&&r(Q)})}E(y,B),ae(),g()}var la=G("<button><!></button>"),ca=G('<div><div></div> <div><h2>Visibility</h2> <p></p> <form class="svelte-1r4q63y"><div class="option svelte-1r4q63y"><input type="radio" name="visibility" id="private"/><label for="private" aria-label="Private"><!></label></div> <div class="option svelte-1r4q63y"><input type="radio" name="visibility" id="shared" aria-label="Shared"/><label for="shared" aria-label="Shared"><!></label> <!></div> <div class="option svelte-1r4q63y"><input type="radio" name="visibility" id="public" aria-label="Public"/><label for="public" aria-label="Public"><!></label></div> <!></form> <button><!></button></div></div>'),da=G("<!> <!>",1);function ua(y,e){te(e,!0);const[t,g]=ke(),n=()=>o(Y,"$open",t),I=()=>o(x,"$trigger",t),i=()=>o(H,"$portalled",t),s=()=>o(q,"$overlay",t),L=()=>o(D,"$content",t),V=()=>o(z,"$title",t),T=()=>o(C,"$description",t),_=()=>o(M,"$close",t),O=[],{elements:{trigger:x,portalled:H,overlay:q,content:D,title:z,description:C,close:M},states:{open:Y}}=ct();var $=(b=>(b.private="private",b.shared="shared",b.public="public",b))($||{});let K=Z(()=>e.wac?e.wac.public.read?"public":Object.entries(e.wac.agent).some(([b,l])=>b!==e.self&&l.read)?"shared":"private":void 0);const w=rt({visibility:void 0,selected:[]});we(()=>{w.visibility=c(K)});let re=Z(()=>!!e.wac?.agent[e.self].control);we(()=>{if(!e.wac)return;const b=Object.entries(e.wac.agent).filter(([l,f])=>l!==e.self&&f.read===!0).map(([l])=>l);w.selected=b});const ve=async b=>{if(b.preventDefault(),!e.wac)throw new Error;let l=JSON.parse(JSON.stringify(e.wac));if(w.visibility==="public")l.public.read=!0;else if(w.visibility==="shared"&&w.selected.length>0){l.public.read=!1;for(let f in l.agent)f!==e.self&&(l.agent[f].read=!1);w.selected.forEach(f=>{l.agent[f]??={read:!1,append:!1,write:!1,control:!1},l.agent[f].read=!0})}else l=void 0;await e.onchangewac(l),Ee(Y,!1)};var oe=da(),a=ie(oe);{var p=b=>{var l=la();N(l,()=>({"aria-label":`Privacy and sharing: ${c(K)}`,...I()}),void 0,void 0,"svelte-1r4q63y");var f=h(l);{var W=m=>{{let S=Z(()=>c(re)?"green":"black");tt(m,{"aria-hidden":"true",get color(){return c(S)}})}},B=m=>{var S=he(),U=ie(S);{var J=Q=>{{let r=Z(()=>c(re)?"green":"black");at(Q,{"aria-hidden":"true",get color(){return c(r)}})}},ee=Q=>{var r=he(),d=ie(r);{var F=de=>{{let fe=Z(()=>c(re)?"green":"black");et(de,{"aria-hidden":"true",get color(){return c(fe)}})}};se(d,de=>{c(K)===$.public&&de(F)},!0)}E(Q,r)};se(U,Q=>{c(K)===$.shared?Q(J):Q(ee,!1)},!0)}E(m,S)};se(f,m=>{c(K)===$.private?m(W):m(B,!1)})}v(l),j(l,m=>x?.(m)),E(b,l)},u=b=>{Tt(b,{class:"spinning"})};se(a,b=>{e.wac?b(p):b(u,!1)})}var R=P(a,2);{var le=b=>{var l=ca();N(l,()=>({...i()}),void 0,void 0,"svelte-1r4q63y");var f=h(l);N(f,()=>({class:"overlay",...s()}),void 0,void 0,"svelte-1r4q63y"),j(f,k=>q?.(k));var W=P(f,2);N(W,()=>({class:"content",...L()}),void 0,void 0,"svelte-1r4q63y");var B=h(W);N(B,()=>({class:"title",...V()}),void 0,void 0,"svelte-1r4q63y"),j(B,k=>z?.(k));var m=P(B,2);N(m,()=>({...T()}),void 0,void 0,"svelte-1r4q63y"),j(m,k=>C?.(k));var S=P(m,2),U=h(S),J=h(U);Me(J);var ee,Q=P(J),r=h(Q);tt(r,{"aria-hidden":"true"}),v(Q),v(U);var d=P(U,2),F=h(d);Me(F);var de,fe=P(F),X=h(fe);at(X,{"aria-hidden":"true"}),v(fe);var A=P(fe,2);{var ce=k=>{{let ze=Z(()=>w.visibility!==$.shared);oa(k,{get disabled(){return c(ze)},get value(){return w.selected},set value(We){w.selected=We}})}};se(A,k=>{w.visibility===$.shared&&k(ce)})}v(d);var ne=P(d,2),ue=h(ne);Me(ue);var Se,ge=P(ue),dt=h(ge);et(dt,{"aria-hidden":"true"}),v(ge),v(ne);var ut=P(ne,2);pt(ut,{type:"submit",variant:"primary",children:(k,ze)=>{nt();var We=st("Confirm");E(k,We)},$$slots:{default:!0}}),v(S);var Te=P(S,2);N(Te,()=>({class:"close",..._()}),void 0,void 0,"svelte-1r4q63y");var vt=h(Te);Ve(vt,{}),v(Te),j(Te,k=>M?.(k)),v(W),j(W,k=>D?.(k)),v(l),j(l,k=>H?.(k)),Ie(()=>{ee!==(ee=$.private)&&(J.value=(J.__value=$.private)??""),de!==(de=$.shared)&&(F.value=(F.__value=$.shared)??""),Se!==(Se=$.public)&&(ue.value=(ue.__value=$.public)??"")}),gt("submit",S,ve),Be(O,[],J,()=>($.private,w.visibility),k=>w.visibility=k),Be(O,[],F,()=>($.shared,w.visibility),k=>w.visibility=k),Be(O,[],ue,()=>($.public,w.visibility),k=>w.visibility=k),E(b,l)};se(R,b=>{n()&&b(le)})}E(y,oe),ae(),g()}function va(y,e){te(e,!0);const[t,g]=ke(),n=()=>o(i,"$resource",t),I=()=>o(Le,"$session",t),i=He(e.uri);let s=Fe(void 0);we(()=>{n().getWac().then(_=>{if(_.isError)throw _;Pe(s,_,!0)})});const{getResource:L,getSubject:V}=lt(),T=async _=>{if(n()?.type!=="SolidLeaf")throw new Error("not a leaf");if(!c(s))throw new Error;let O=JSON.parse(JSON.stringify(c(s).wacRule));if(_===void 0){const C=await jt(n(),{fetch:I().fetch});if(C.isError)throw C;const M=C.wacUri;await L(M).delete()}else await n().setWac(_);const x=await n().getWac({ignoreCache:!0});if(x.isError)throw x;Pe(s,x,!0);const H=x.wacRule,q=H.public.read?"public":Object.entries(H.agent).some(([C,M])=>C!==I().info.webId&&M.read)?"shared":"private";_e({data:{title:"Update successful",description:`Access was updated to ${q}`,type:$e.success}}),O.public.read!==H.public.read&&_e({data:{title:"TODO Notification successful",description:"Public geoindex was notified",type:$e.success}});const D=Object.keys(H.agent),z=Object.keys(O.agent);for(let C of D)z.includes(C)||_e({data:{title:"TODO Notification successful",description:`${V(ye,C)?.name} was notified`,type:$e.success}})};{let _=Z(()=>c(s)?.wacRule);ua(y,{get wac(){return c(_)},get self(){return I().info.webId},onchangewac:T})}ae(),g()}const fa=async(y,e,t,g)=>{const{name:n}=e.place;if(globalThis.confirm(`Do you really want to delete place ${n} (${e.place["@id"]})?`)){const i=t.getResource(e.place["@id"]);if(i.isError)throw i;const s=await Dt(i,{fetch:g().fetch,dataset:t});s.isError?_e({data:{type:$e.error,title:"Deletion failed",description:s.name}}):_e({data:{type:$e.success,title:"Deletion successful",description:`Deleted place ${n}`}})}};var pa=G("<div><div></div> <div><h2>Update Place</h2> <p></p> <!> <button><!></button></div></div>"),ba=G('<div class="controls svelte-1hcqejf"><!> <button><!></button> <button aria-label="Delete place"><!></button></div> <!>',1);function ha(y,e){te(e,!0);const[t,g]=ke(),n=()=>o(w,"$open",t),I=()=>o(Le,"$session",t),i=()=>o(D,"$trigger",t),s=()=>o(z,"$portalled",t),L=()=>o(C,"$overlay",t),V=()=>o(M,"$content",t),T=()=>o(Y,"$title",t),_=()=>o($,"$description",t),O=()=>o(K,"$close",t),{changeData:x,commitData:H,dataset:q}=lt(),{elements:{trigger:D,portalled:z,overlay:C,content:M,title:Y,description:$,close:K},states:{open:w}}=ct(),re=async f=>{const{name:W}=e.place,B=q.getResource(e.place["@id"]);if(B.isError)throw B;const m=x(e.place,B);m.name=f.name,m.description=f.description,m.topic=Lt(...f.topics.map(U=>({"@id":U})));const S=await H(m);if(S.isError)throw S;Ee(w,!1),_e({data:{title:"Update successful",description:`Updated place ${W}`,type:$e.success}})};var ve=ba(),oe=ie(ve),a=h(oe);va(a,{get uri(){return e.place["@id"]}});var p=P(a,2);N(p,()=>({"aria-label":"Edit place",...i()}),void 0,void 0,"svelte-1hcqejf");var u=h(p);Qt(u,{"aria-hidden":"true"}),v(p),j(p,f=>D?.(f));var R=P(p,2);R.__click=[fa,e,q,I];var le=h(R);Xt(le,{"aria-hidden":"true"}),v(R),v(oe);var b=P(oe,2);{var l=f=>{var W=pa();N(W,()=>({...s()}),void 0,void 0,"svelte-1hcqejf");var B=h(W);N(B,()=>({class:"overlay",...L()}),void 0,void 0,"svelte-1hcqejf"),j(B,r=>C?.(r));var m=P(B,2);N(m,()=>({class:"content",...V()}),void 0,void 0,"svelte-1hcqejf");{const r=d=>{nt();var F=st("Update place");E(d,F)};var S=h(m);N(S,()=>({class:"title",...T()}),void 0,void 0,"svelte-1hcqejf"),j(S,d=>Y?.(d));var U=P(S,2);N(U,()=>({..._()}),void 0,void 0,"svelte-1hcqejf"),j(U,d=>$?.(d));var J=P(U,2);{let d=Z(()=>({name:e.place.name,description:e.place.description,latitude:e.place.geo.latitude,longitude:e.place.geo.longitude,topics:e.place.topic?.map(F=>F["@id"])??[]}));Bt(J,{get place(){return c(d)},onsubmit:re,get submit(){return r}})}var ee=P(J,2);N(ee,()=>({class:"close",...O()}),void 0,void 0,"svelte-1hcqejf");var Q=h(ee);Ve(Q,{}),v(ee),j(ee,d=>K?.(d)),v(m),j(m,d=>M?.(d))}v(W),j(W,r=>z?.(r)),E(f,W)};se(b,f=>{n()&&f(l)})}E(y,ve),ae(),g()}it(["click"]);var ga=G("<li><!></li>"),ma=G('<ul data-testid="place-list"></ul>');function Ta(y,e){te(e,!0);const[t,g]=ke(),n=()=>o(Le,"$session",t),I=()=>o(i,"$places",t);we(()=>{n().info.webId&&At(n().info.webId,n().fetch).then(()=>{console.log("query run and finished")})});const i=Mt(Jt,Vt.type,Ht.Place);var s=ma();Ue(s,5,I,L=>L["@id"],(L,V)=>{var T=ga(),_=h(T);zt(_,{get place(){return c(V)},children:(O,x)=>{ha(O,{get place(){return c(V)}})},$$slots:{default:!0}}),v(T),E(L,T)}),v(s),E(y,s),ae(),g()}export{Ta as component};
